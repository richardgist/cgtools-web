<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CG Toolbox</title>
    <!-- UI/UX Pro Max: Geometric Modern Typography -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Work+Sans:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- 标题栏 -->
    <header class="title-bar">
        <h1>🛠️ CG Toolbox</h1>
        <span class="subtitle">Developer Tool Panel</span>
    </header>

    <div class="container">
        <!-- 左侧导航 -->
        <nav class="sidebar">
            <div class="sidebar-item active" onclick="showPage('scripts')" title="脚本运行器">
                📜<span>脚本</span>
            </div>
            <div class="sidebar-item" onclick="showPage('claude')" title="Claude 配置">
                🔧<span>配置</span>
            </div>
            <div class="sidebar-item" onclick="showPage('svn')" title="SVN Patch">
                📦<span>SVN</span>
            </div>
        </nav>

        <!-- 内容区 -->
        <main class="content">
            <!-- 脚本运行器 -->
            <div id="scripts-page" class="page active">
                <div class="script-list-panel">
                    <div class="header">
                        📜 可用脚本
                        <button class="btn btn-secondary" style="padding: 6px 10px; font-size: 11px;"
                            onclick="loadScripts()">↻ 刷新</button>
                    </div>
                    <div class="script-items" id="script-items"></div>
                </div>
                <div class="terminal-panel">
                    <div class="terminal-header">
                        <span class="title" id="selected-script">请选择脚本</span>
                        <div class="actions">
                            <button class="btn btn-success" id="run-btn" onclick="runScript()" disabled>▶ 运行</button>
                            <button class="btn btn-danger" id="stop-btn" onclick="stopScript()" disabled>⏹ 停止</button>
                            <button class="btn btn-secondary" onclick="clearTerminal()">🗑️ 清空</button>
                        </div>
                    </div>
                    <div class="terminal" id="script-terminal"></div>
                </div>
            </div>

            <!-- Claude 配置 -->
            <div id="claude-page" class="page">
                <div class="group-box">
                    <div class="group-box-title">📌 当前激活配置</div>
                    <div id="current-config">未激活任何配置</div>
                </div>

                <div class="group-box" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <div class="group-box-title">📋 所有配置</div>
                    <div class="config-list-container" id="config-list"></div>
                </div>

                <div class="group-box">
                    <div class="group-box-title">➕ 添加配置</div>
                    <div class="form-row">
                        <label>名称:</label>
                        <input type="text" id="config-name" placeholder="配置名称">
                        <label>API:</label>
                        <input type="text" id="config-api" placeholder="https://api.anthropic.com"
                            value="https://api.anthropic.com">
                    </div>
                    <div class="form-row">
                        <label>Token:</label>
                        <input type="password" id="config-token" placeholder="API Token" style="flex: 2;">
                        <button class="btn btn-success" onclick="addConfig()">➕ 添加</button>
                    </div>
                </div>

                <div class="actions-row">
                    <button class="btn btn-primary" onclick="switchConfig()">🔄 切换配置</button>
                    <button class="btn btn-danger" onclick="deleteConfig()">🗑️ 删除</button>
                    <button class="btn btn-secondary" onclick="loadConfigs()">↻ 刷新</button>
                </div>
            </div>

            <!-- SVN Patch -->
            <div id="svn-page" class="page">
                <div class="group-box">
                    <div class="group-box-title">📁 路径配置</div>
                    <div class="path-row">
                        <label>路径 A:</label>
                        <input type="text" id="path-a" placeholder="本地路径或 SVN URL">
                    </div>
                    <div class="path-info" id="path-a-info"></div>
                    <div class="path-row">
                        <label>路径 B:</label>
                        <input type="text" id="path-b" placeholder="目标路径">
                    </div>
                    <div class="path-info" id="path-b-info"></div>
                    <div class="path-actions">
                        <select id="direction" style="width: 110px;">
                            <option value="AtoB">A → B</option>
                            <option value="BtoA">B → A</option>
                        </select>
                        <button class="btn btn-secondary" onclick="swapPaths()">🔄 交换</button>
                    </div>
                </div>

                <div class="group-box">
                    <div class="group-box-title">⚙️ 操作</div>
                    <div class="operation-row">
                        <label style="min-width: 60px; text-align: right;">提交号:</label>
                        <input type="text" id="revision" placeholder="12345 或 12345:12350" style="width: 180px;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="from-repo-root"> 仓库根
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="use-parent"> 上级路径
                        </label>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewLog()">📋 查看日志</button>
                        <button class="btn btn-success" onclick="generatePatch()">📄 生成 Patch</button>
                        <button class="btn btn-secondary" id="save-patch-btn" onclick="savePatch()" disabled>💾
                            保存</button>
                        <button class="btn btn-warning" id="apply-patch-btn" onclick="applyPatch()" disabled>🚀
                            应用</button>
                    </div>
                </div>

                <div class="preview-area">
                    <div class="diff-panel group-box">
                        <div class="group-box-title">📝 Patch 预览</div>
                        <div class="diff-content terminal" id="diff-content"></div>
                    </div>
                    <div class="log-panel group-box">
                        <div class="group-box-title">
                            📋 操作日志
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 10px;"
                                onclick="clearSvnLog()">清空</button>
                        </div>
                        <div class="log-content terminal" id="svn-log"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 状态栏 -->
    <footer class="status-bar">
        <span id="status-text">就绪</span>
        <span>http://localhost:8000</span>
    </footer>

    <script src="app.js"></script>
</body>

</html>